{"version":3,"file":"static/webpack/static/development/pages/addname.js.9df40cd8f434d31d417f.hot-update.js","sources":["webpack:///./components/CreateWoman.js"],"sourcesContent":["import React, { Component, Fragment } from \"react\";\nimport { Mutation } from \"react-apollo\";\nimport Link from \"next/link\";\nimport withApollo from \"next-with-apollo\";\nimport gql from \"graphql-tag\";\nimport Router from \"next/router\";\nimport Form, { Button } from \"./styles/Form\";\nimport Error from \"./ErrorMessage\";\nimport { ApolloConsumer } from \"react-apollo\";\nimport { genId } from \"./helpers\";\nimport { ALL_WOMEN_QUERY } from \"./Women\";\n\nconst CREATE_WOMAN_MUTATION = gql`\n  mutation CREATE_WOMAN_MUTATION($name: String!, $slug: String!) {\n    createWoman(name: $name, slug: $slug) {\n      name\n      slug\n      id\n    }\n  }\n`;\n\nconst QUERY_WOMEN = gql`\n  query WOMAN_QUERY($slug: String!) {\n    women(where: { slug: $slug }) {\n      id\n      name\n      slug\n      createdAt\n    }\n  }\n`;\n\nconst WOMAN_QUERY_NO_ARGS = gql`\n  query WOMAN_QUERY {\n    women {\n      id\n      name\n      slug\n      createdAt\n    }\n  }\n`;\n\nclass CreateWoman extends Component {\n  state = {\n    name: \"\"\n  };\n  handleChange = e => {\n    const { type, value } = e.target;\n    const val = type === \"number\" ? parseFloat(value) : value;\n    const slug = genId(val);\n    this.setState({ name: val, slug: slug });\n  };\n  render() {\n    return (\n      <ApolloConsumer>\n        {client => {\n          return (\n            <Mutation mutation={CREATE_WOMAN_MUTATION} variables={this.state}>\n              {(createWoman, { loading, error }) => (\n                <Form\n                  onSubmit={async e => {\n                    e.preventDefault();\n\n                    const name = this.state.name.toLowerCase();\n\n                    console.log(this.state.slug);\n\n                    const { data } = await client.query({\n                      query: QUERY_WOMEN,\n                      variables: {\n                        slug: this.state.slug\n                      }\n                    });\n                    // if the query for this name returns with any results,\n\n                    console.log(data.women);\n                    console.log(data.women.length);\n                    if (data.women.length > 0) {\n                      console.log(\"not adding to db\");\n\n                      // Router.push(`/names#${this.state.slug}`);\n                      // this.setState({ name: \"\", slug: \"\" });\n                    } else {\n                      console.log(\"adding to db\");\n                      // only run query if data.women did not have any items in it\n                      // const res = await createWoman({\n                      //   refetchQueries: [\n                      //     {\n                      //       query: ALL_WOMEN_QUERY\n                      //     }\n                      //   ]\n                      // });\n                      // const totalRes = await client.query({\n                      //   query: WOMAN_QUERY_NO_ARGS\n                      // });\n\n                      // console.log(totalRes.data);\n\n                      // Router.push(`/names#${this.state.slug}`);\n                      // this.setState({ name: \"\", slug: \"\" });\n                    }\n                  }}\n                >\n                  <Link href=\"/names\">\n                    <a>\n                      <svg\n                        className=\"close\"\n                        width=\"31\"\n                        height=\"31\"\n                        viewBox=\"0 0 31 31\"\n                        fill=\"none\"\n                        xmlns=\"http://www.w3.org/2000/svg\"\n                      >\n                        <path\n                          d=\"M9.20022 24.7566L5.6216 21.178L11.5109 15.2887L5.88929 9.6671L9.66706 5.88934L15.2887 11.5109L21.1779 5.62164L24.7566 9.20027L18.8673 15.0896L24.5163 20.7386L20.7385 24.5163L15.0895 18.8673L9.20022 24.7566Z\"\n                          fill=\"black\"\n                        />\n                      </svg>\n                    </a>\n                  </Link>\n                  <Error error={error} />\n                  <fieldset disabled={loading} aria-busy={loading}>\n                    <div className=\"wrapper\">\n                      <label htmlFor=\"title\">\n                        Name\n                        <input\n                          // onFocus={this.props.onFocus}\n                          // onBlur={this.props.onBlur}\n                          type=\"text\"\n                          id=\"name\"\n                          name=\"name\"\n                          placeholder=\"...\"\n                          required\n                          value={this.state.name}\n                          onChange={this.handleChange}\n                        />\n                      </label>\n                      <Button\n                        willdisplay={this.state.name.length > 0}\n                        type=\"submit\"\n                      >\n                        <span>Submit</span>\n                        <svg\n                          width=\"24\"\n                          height=\"25\"\n                          viewBox=\"0 0 24 25\"\n                          fill=\"none\"\n                          xmlns=\"http://www.w3.org/2000/svg\"\n                        >\n                          <path\n                            d=\"M23 19L23 19.75L23.75 19.75L23.75 19L23 19ZM0.469667 18.4697C0.176775 18.7626 0.176775 19.2374 0.469667 19.5303L5.24264 24.3033C5.53553 24.5962 6.01041 24.5962 6.3033 24.3033C6.59619 24.0104 6.59619 23.5355 6.3033 23.2426L2.06066 19L6.3033 14.7574C6.59619 14.4645 6.59619 13.9896 6.3033 13.6967C6.01041 13.4038 5.53553 13.4038 5.24264 13.6967L0.469667 18.4697ZM22.25 1.84178e-06L22.25 19L23.75 19L23.75 1.97292e-06L22.25 1.84178e-06ZM23 18.25L0.999998 18.25L0.999998 19.75L23 19.75L23 18.25Z\"\n                            fill=\"black\"\n                          />\n                        </svg>\n                      </Button>\n                    </div>\n                  </fieldset>\n                </Form>\n              )}\n            </Mutation>\n          );\n        }}\n      </ApolloConsumer>\n    );\n  }\n}\n\nexport default CreateWoman;\nexport { CREATE_WOMAN_MUTATION };\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAUA;AAWA;AACA;AAUA;;;;;;;;;;;;;;;;;;AACA;AACA;AADA;AACA;AAEA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;;;;;;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AAEA;AAEA;AALA;AAAA;AAQA;AACA;AACA;AADA;AAFA;AACA;AARA;AAAA;AAOA;AAMA;AAEA;AACA;AACA;AAAA;AACA;AAGA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AAzCA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AA4CA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AANA;AAAA;AAAA;AAAA;AAAA;AAAA;AASA;AACA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AATA;AAAA;AAAA;AAAA;AAAA;AAAA;AAaA;AACA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AALA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQA;AACA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AA3FA;AAuGA;AAGA;;;;AA1HA;AACA;AA4HA;;;;;A","sourceRoot":""}